# How to create your own career in Flight Build Sandbox Simulator

## Введение

Игра поддерживает создание и импорт сторонних карьер. В этой документации подробно описаны принципы создания карьеры, а также структура проекта, чтобы упростить процесс разработки и интеграции.
Файлы карьеры находятся по пути Файлы карьеры находятся по следующему пути: `Android/data/com.GullSoft.AircraftSimulator/files/Career/<имя карьеры>`.

## Структура проекта

Проект карьеры организован в виде нескольких папок, каждая из которых содержит ресурсы для различных аспектов игры

⚠️Внимательно создавайте базовые папки. Отсутствие или неправильное наименование базовых папок/файлов в структуре карьеры приводит к ошибкам игры. Ниже указана обязательная архитектура папок и файлов⚠️

```plaintext
/Main Career Folder
│
├── /Aircrafts
├── /Maps
├── /Cache
├── /Demo
│   ├── NameKey.txt
│   ├── DescriptionKey.txt
│   └── icone.(jpg/png)
├── /Localization
│   └── English.txt
├── /Skripts
    ├── SaveKey.txt
│   ├── Main.lua
│   └── Exit.lua
├── /Textures
└── /Audios
```

### Папки:

- **Aircrafts**  
  Содержит файлы сохранений всех билдов.

- **Maps**  
  Содержит файлы сохранений всех карт.

- **Audios**  
  Содержит файлы музыки. Файлы должны обязательно иметь разрешение `.ogg`.

- **Cache**  
  Временные файлы и данные, которые создаются в процессе игры.

- **Demo**  
  Содержит три элемента: `DescriptionKey.txt`, `icone.jpg`, `NameKey.txt`. (Менять название файлов запрещено.) 
  - `DescriptionKey.txt` содержит ключ локализации для базового описания карьеры в списке других карьер. 
  - `NameKey.txt` содержит ключ локализации для названия. 
  - `icone.jpg` — картинка иконки карьеры в формате 16:3, например 800x150.

- **Localization**  
  Файлы локализации для перевода текста игры на разные языки.

- **Skripts**  
  Содержит скрипты, отвечающие за логику игры и управление процессом карьеры.

- **Textures**  
  Содержит изображения в формате `.png` или `.jpg`.

## Объяснение базовых механик

### Консоль

Чтобы открыть консоль, прикоснитесь к экрану 4 пальцами одновременно.

### Миссии и Карты

Поместите используемые в карьере карты и постройки в соответствующие папки: `Aircrafts` и `Maps`. Чтобы уменьшить размер файла карьеры в игре, существует система нахождения текстур в первом попавшемся сохранении конкретной карьеры. Например, если есть 5 карт, которые используют одни и те же текстуры, вы можете удалить все эти текстуры из папок Textures почти во всех билдах, оставив их лишь в одном.

Как вы могли видеть в редакторе построек и карт, есть пункт сортировки миссий. Эти элементы используются для создания карт с миссиями. Почитайте описание каждого элемента, особенно в редакторе карт, чтобы понять, что к чему. Для этого кликните по элементу в списке деталей.

### Локализация

В FBS (Flight Build Sandbox Simulator) используется кастомная система локализации. Как вы могли видеть, в файлах игры есть папка Localization. На данный момент в ней лежат файлы English.txt, Russian.txt. Это и есть файлы локализации. В них хранятся элементы формата `Ключ_1 = Значение 1`. При создании ключа используйте `_` вместо пробелов.

Вы также можете создать файл для нового языка, например, `German.txt`, и переименовать его, взяв за основу `English.txt`. После перевода всех значений на немецкий язык, вы сможете легко переключать язык в настройках игры. Важным аспектом является то, что в папке локализации карьеры должны находиться файлы с такими же именами, как и в основной папке, чтобы система могла правильно дополнить базовые файлы локализации. Если вы не планируете делать локализацию на разные языки в файлах локализации карьеры обязательно должен быть файл `English.txt` так как Англиский основной язык игры.

Таким образом, структура локализации обеспечивает простоту добавления новых языков и поддерживает гибкость в изменении текста в игре. В дальнейшем мы можем получить значение по ключу в скрипте Lua, что позволяет динамически получать текст в зависимости от выбранного языка.

### Скриптинг

В FBS для создания карьеры используется язык программирования Lua.
В папке Skripts хранятся файлы скриптов. Они могут иметь разрешение `.txt` или `.lua`.
В папке Skripts обязательно должны храниться файлы `Main.(lua, txt)`, `Exit.(lua, txt)` и `SaveKey.txt`.

SaveKey.txt — файл, в котором хранится ключ для сохранения данных о карьере. Вы можете его заменить, и тогда весь прогресс карьеры будет утрачен. Постарайтесь делать этот ключ из случайных букв и цифр, чтобы избежать повторений в других карьерах. Например: `sdfgsd2323ri3k4jr23ioh423ihnf85f3o`.

Main.lua — файл, который выполняется при загрузке меню карьеры. Его базовая структура представляет собой:

```lua
-- Your main code here

-- System
UpdateTreeScrollArea()
InitializeTreeData()
SetTotalMissionCount(10) -- your mission count
UpdateFastList()
```

Exit.lua — файл, который выполняется перед выходом в главное меню. Он может быть пустым, но вы можете использовать его, например, для сохранения текущего проигрываемого времени музыки, чтобы воспроизвести её с того же момента.

## Синтаксис

### Основные типы данных
nil - отсутствующее значение, используется для обозначения пустоты.
boolean - логические значения: true и false.
number - числовые значения (например, 42, 3.14).
string - строки, заключенные в одинарные или двойные кавычки (например, 'Hello', "World").
table - структуры данных, аналогичные массивам или словарям, создаваемые с помощью фигурных скобок (например, {1, 2, 3} или {key = "value"}).
function - функции, которые можно присваивать переменным и передавать как аргументы.
Передача значений
Числа: передаются как есть, например, SetTotalMissionCount(8).
Строки: передаются в виде строковых литералов, например, LoadMap('Base Lobby').
Таблицы: передаются в виде литералов, например, SpawnTechTreeItem(0, 0, 'Cessna 172', 0, {SpecificationType('P', 1)}, 'Cessna 172', 'Cessna_172_Description', Pos2(0, 0), techItemColor).
Функции: можно передавать как аргументы.

### Описание доступных методов

### 1. HexColor(string hex)
Преобразует строку с шестнадцатеричным значением цвета в объект Color.
- **Параметры:**
  - hex (string): Шестнадцатеричное представление цвета.
- **Возвращает:** Color — цвет, соответствующий переданному значению.
- **Назначение:** Преобразование шестнадцатеричных значений в цвета.

### 2. Color(float r, float g, float b, float a)
Создает объект Color с заданными компонентами.
- **Параметры:**
  - r (float): Красный компонент.
  - g (float): Зеленый компонент.
  - b (float): Синий компонент.
  - a (float): Альфа компонент.
- **Возвращает:** Color — новый цвет.
- **Назначение:** Упрощение создания цветов с заданными компонентами.

### 3. SpecificationType(string label, int efficiency)
Создает объект AircraftSpecificationTypeAircraftItem с заданными параметрами.
- **Параметры:**
  - label (string): Метка для спецификации.
  - efficiency (int): Эффективность.
- **Возвращает:** AircraftSpecificationTypeAircraftItem — новый элемент спецификации.
- **Назначение:** Создание спецификаций для различных самолетов.

### 10. Read(string scriptName)
Читает и выполняет Lua-скрипт по имени.
- **Параметры:**
  - scriptName (string): Имя скрипта для выполнения.
- **Назначение:** Загрузка и выполнение заданного скрипта.

### 11. IsAircraftPurchased(int id)
Проверяет, куплен ли самолет с указанным ID.
- **Параметры:**
  - id (int): ID самолета.
- **Возвращает:** bool — true, если самолет куплен; иначе false.
- **Назначение:** Проверка состояния покупки самолета.

### 12. AddMoney(int money)
Добавляет указанную сумму денег к счету игрока.
- **Параметры:**
  - money (int): Сумма денег для добавления.
- **Назначение:** Увеличение суммы денег игрока.

### 13. LoadMap(string mapName)
Загружает карту по имени.
- **Параметры:**
  - mapName (string): Имя карты для загрузки.
- **Назначение:** Инициализация и отображение карты.

### 14. PlayAudio(string fileName)
Проигрывает аудиофайл с заданным именем.
- **Параметры:**
  - fileName (string): Имя аудиофайла для воспроизведения.
- **Назначение:** Воспроизведение музыки в игре.

### 15. GetAudioTime()
Возвращает текущее время аудио.
- **Возвращает:** float — текущее время в воспроизводимом аудиофайле.
- **Назначение:** Получение информации о времени аудио.

### 16. SetAudioTime(float time)
Устанавливает текущее время воспроизведения аудио.
- **Параметры:**
  - time (float): Время для установки.
- **Назначение:** Установка времени для воспроизведения аудио.

### 17. GetAudioLength()
Возвращает длительность аудиофайла.
- **Возвращает:** float — длина аудиофайла.
- **Назначение:** Получение информации о длительности аудио.

### 18. SetMoneySymbol(string symbol)
Устанавливает символ для отображения денег.
- **Параметры:**
  - symbol (string): Символ для отображения.
- **Назначение:** Настройка символа валюты в игре.

### 19. RegistryAircraftSpecificationType(string label, string descriptionTag, Color color)
Регистрирует новый тип спецификации самолета.
- **Параметры:**
  - label (string): Метка типа.
  - descriptionTag (string): Тег описания.
  - color (Color): Цвет для типа.
- **Назначение:** Регистрация новых типов спецификаций для самолетов.

### 20. SpawnTechTreeItem(int id, int requiredId, string buildName, int price, AircraftSpecificationTypeAircraftItem[] aircraftSpecificationTypeAircraftItems, string nameTag, string descriptionTag, Vector2 position, Color color)
Создает элемент дерева технологий.
- **Параметры:**
  - id (int): ID элемента.
  - requiredId (int): ID требуемого элемента.
  - buildName (string): Имя постройки.
  - price (int): Цена элемента.
  - aircraftSpecificationTypeAircraftItems (AircraftSpecificationTypeAircraftItem[]): Массив спецификаций для самолета.
  - nameTag (string): Тег имени.
  - descriptionTag (string): Тег описания.
  - position (Vector2): Позиция для спауна.
  - color (Color): Цвет элемента.
- **Назначение:** Создание и добавление элемента в дерево технологий.

### 21. UpdateTreeScrollArea()
Обновляет область прокрутки дерева технологий.
- **Назначение:** Обновление визуального состояния дерева технологий.

### 22. InitializeTreeData()
Инициализирует данные дерева технологий.
- **Назначение:** Подготовка данных для отображения в дереве технологий.

### 23. SpawnArrow(Vector2 position, string direction, Color color)
Создает стрелку на указанной позиции с заданным направлением и цветом.
- **Параметры:**
  - position (Vector2): Позиция для спауна стрелки.
  - direction (string): Направление стрелки.
  - color (Color): Цвет стрелки.
- **Назначение:** Создание визуальных направляющих стрелок.

### 24. SetUiElementColor(string tag, Color color)
Устанавливает цвет UI-элемента по тегу.
- **Параметры:**
  - tag (string): Тег UI-элемента.
  - color (Color): Новый цвет для элемента.
- **Назначение:** Настройка визуального представления UI-элементов.

### 25. SetTotalMissionCount(int count)
Устанавливает общее количество миссий.
- **Параметры:**
  - count (int): Общее количество миссий.
- **Назначение:** Обновление информации о миссиях.

### 26. UpdateFastList()
Обновляет быстрый список элементов.
- **Назначение:** Пересчитывает и обновляет визуальное представление быстрого списка.

### 27. SaveString(string key, string value)
Сохраняет строку в PlayerPrefs.
- **Параметры:**
  - key (string): Ключ для сохранения.
  - value (string): Значение для сохранения.
- **Назначение:** Хранение строковых данных между сессиями.

### 28. LoadString(string key)
Загружает строку из PlayerPrefs.
- **Параметры:**
  - key (string): Ключ для загрузки.
- **Возвращает:** string — загруженное значение или null, если ключ отсутствует.
- **Назначение:** Извлечение строковых данных из PlayerPrefs.

### 29. Clear()
Очищает все данные.
- **Назначение:** Сброс состояния игры и очистка данных.

### 30. SetResolution(int width, int height)
Устанавливает разрешение игры.
- **Параметры:**
  - width (int): Ширина разрешения.
  - height (int): Высота разрешения.
- **Назначение:** Настройка разрешения игры.

### 31. SetFullScreen(bool isFullScreen)
Устанавливает полноэкранный режим.
- **Параметры:**
  - isFullScreen (bool): true для полноэкранного режима; false для оконного.
- **Назначение:** Управление режимом отображения игры.

### 32. SetAudioVolume(float volume)
Устанавливает громкость аудио.
- **Параметры:**
  - volume (float): Новая громкость (0.0 до 1.0).
- **Назначение:** Настройка громкости аудио в игре.

### 33. SaveGame()
Сохраняет текущее состояние игры.
- **Назначение:** Хранение прогресса игрока.

### 34. LoadGame()
Загружает сохраненное состояние игры.
- **Назначение:** Восстановление прогресса игрока.

### 35. ShowMessage(string message)
Отображает сообщение на экране.
- **Параметры:**
  - message (string): Сообщение для отображения.
- **Назначение:** Информирование игрока о событиях.
